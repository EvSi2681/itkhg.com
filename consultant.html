<div class="consultant-section">
  <!-- –õ–æ–≥–æ—Ç–∏–ø -->
  <img src="https://i.postimg.cc/1zPrLjFb/8.png" alt="AI Consultant Logo" id="ai-logo">

  <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ -->
  <h2>–í–∞—à —Ñ–∞—Ä–º–∞—Ü–µ–≤—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç AI IWIT</h2>
  <p>–ù–∞–ø–∏—à–∏—Ç–µ, —á—Ç–æ –≤–∞—Å –±–µ—Å–ø–æ–∫–æ–∏—Ç ‚Äî —è –ø–æ–¥–±–µ—Ä—É –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ.</p>

  <!-- –ß–∞—Ç -->
  <div id="chat-container">
    <div id="messages"></div>
    <input type="text" id="user-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –≤–æ–ø—Ä–æ—Å..." />
    <button onclick="sendQuery()">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
  </div>

  <!-- –°–∫—Ä–∏–ø—Ç —á–∞—Ç–∞ -->
  <script>
    async function sendQuery() {
      const input = document.getElementById("user-input");
      const messages = document.getElementById("messages");

      const userMessage = input.value.trim();
      if (!userMessage) return;

      // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
      messages.innerHTML += `<p><strong>–í—ã:</strong> ${userMessage}</p>`;

      try {
        // –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∑–∞–ø—Ä–æ—Å –Ω–∞ –≤–∞—à API —á–µ—Ä–µ–∑ Vercel-–ø—Ä–æ–∫—Å–∏
        const response = await fetch("/api/chat", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ message: userMessage })
        });

        const data = await response.json();
        const reply = data.reply || "–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –æ—Ç–≤–µ—Ç.";

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –æ—Ç–≤–µ—Ç –ò–ò
        messages.innerHTML += `<p><strong>AI:</strong> ${reply}</p>`;

        // –ö–Ω–æ–ø–∫–∞ WhatsApp
        const phone = "+79871149378";
        const waMsg = encodeURIComponent(`–ó–¥—Ä–∞–≤—Å—Ç–≤—É–π—Ç–µ, –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—Ç —Å—Ä–µ–¥—Å—Ç–≤–æ: ${userMessage}`);
        messages.innerHTML += `
          <p style="text-align: center; margin-top: 15px;">
            <a href="https://wa.me/${phone}?text=${waMsg}" target="_blank" style="background-color: #25D366; color: white; padding: 10px 20px; text-decoration: none; border-radius: 5px; font-weight: bold;">
              üí¨ –ù–∞–ø–∏—Å–∞—Ç—å –≤ WhatsApp
            </a>
          </p>`;
      } catch (error) {
        messages.innerHTML += `<p><strong>–û—à–∏–±–∫–∞:</strong> –ù–µ —É–¥–∞–ª–æ—Å—å —Å–≤—è–∑–∞—Ç—å—Å—è —Å –∫–æ–Ω—Å—É–ª—å—Ç–∞–Ω—Ç–æ–º. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –ø–æ–∑–∂–µ.</p>`;
        console.error("–û—à–∏–±–∫–∞ —á–∞—Ç–∞:", error);
      }

      // –û—á–∏—Å—Ç–∫–∞ –ø–æ–ª—è –≤–≤–æ–¥–∞ –∏ –ø—Ä–æ–∫—Ä—É—Ç–∫–∞ –≤–Ω–∏–∑
      input.value = "";
      messages.scrollTop = messages.scrollHeight;
    }

    // –†–∞–∑—Ä–µ—à–∞–µ–º –æ—Ç–ø—Ä–∞–≤–∫—É –ø–æ –Ω–∞–∂–∞—Ç–∏—é Enter
    document.getElementById("user-input").addEventListener("keypress", function(e) {
      if (e.key === "Enter") sendQuery();
    });
  </script>
</div>
